var PriceSimulator = function(io, settings){
    this.initialize(io, settings);
};

PriceSimulator.prototype = {
    
    initialize : function(io, settings){
        this.io = io;
        this.settings = settings;
    },
    
    start : function(){
        for(var i in this.settings){
            this.publish(this.settings[i]);
        }
        console.log("PriceSimulator.start");
    },
    
    publish : function(setting){
        var self = this;
        setInterval(function(){
            self.doPublish(setting);
        }, setting.interval);
    },
        
    doPublish : function(setting){

        this.io.sockets.emit('price', {
            currencyPair : setting.currencyPair,
            bid : setting.nextBid(),
            ask : setting.nextAsk()
        });
    }
    
};

exports.createPriceSimulator = function(){
    return new PriceSimulator(arguments[0], arguments[1]);   
};